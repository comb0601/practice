<Window x:Class="INotifyPropertyChangedDemo.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:local="clr-namespace:INotifyPropertyChangedDemo"
        Title="Lesson 2: INotifyPropertyChanged Optimization" Height="750" Width="1300"
        Background="#F5F5F5">
    <Window.Resources>
        <Style x:Key="HeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="Bold"/>
            <Setter Property="Foreground" Value="#2196F3"/>
            <Setter Property="Margin" Value="5,10,5,5"/>
        </Style>
        <Style x:Key="CodeStyle" TargetType="TextBlock">
            <Setter Property="FontFamily" Value="Consolas"/>
            <Setter Property="FontSize" Value="11"/>
            <Setter Property="Background" Value="#F5F5F5"/>
            <Setter Property="Padding" Value="5"/>
            <Setter Property="Margin" Value="5"/>
        </Style>
    </Window.Resources>

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2196F3" CornerRadius="5" Padding="15" Margin="0,0,0,10">
            <StackPanel>
                <TextBlock Text="INotifyPropertyChanged Optimization"
                          FontSize="24" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="Master efficient INPC implementations for optimal binding performance"
                          FontSize="14" Foreground="White" Opacity="0.9" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <TabControl Grid.Row="1" Margin="0,0,0,10">
            <!-- Tab 1: Basic vs Optimized INPC -->
            <TabItem Header="Basic vs Optimized">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Naive Implementation -->
                    <GroupBox Grid.Column="0" Header="Naive INPC (Inefficient)">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderStyle}" Text="Always Raises Events"/>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Implementation:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
set
{
    _field = value;
    OnPropertyChanged(); // Always raises!
}
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Test Naive Implementation:" FontWeight="Bold"/>
                                    <TextBox Text="{Binding NaiveModel.Name, UpdateSourceTrigger=PropertyChanged}"
                                           Margin="5"/>
                                    <Button Content="Set Same Value 1000x" Click="TestNaive_Click" Margin="5"/>
                                    <TextBlock Text="{Binding NaiveEventCount, StringFormat='Events Raised: {0}'}"
                                             Foreground="Red" FontWeight="Bold" FontSize="14" Margin="5"/>
                                    <TextBlock Text="{Binding NaiveExecutionTime}"
                                             Foreground="Red" FontSize="12" Margin="5"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#FFEBEE" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="❌ Problems:" FontWeight="Bold" Foreground="Red"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Raises events even when value unchanged
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Triggers unnecessary UI updates
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Wastes CPU cycles
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Can cause infinite loops
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>

                    <!-- Optimized Implementation -->
                    <GroupBox Grid.Column="1" Header="Optimized INPC (Efficient)">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderStyle}" Text="With Equality Check"/>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Implementation:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
set
{
    if (EqualityComparer&lt;T&gt;.Default
        .Equals(_field, value))
        return; // Skip if same!

    _field = value;
    OnPropertyChanged();
}
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Test Optimized Implementation:" FontWeight="Bold"/>
                                    <TextBox Text="{Binding OptimizedModel.Name, UpdateSourceTrigger=PropertyChanged}"
                                           Margin="5"/>
                                    <Button Content="Set Same Value 1000x" Click="TestOptimized_Click" Margin="5"/>
                                    <TextBlock Text="{Binding OptimizedEventCount, StringFormat='Events Raised: {0}'}"
                                             Foreground="Green" FontWeight="Bold" FontSize="14" Margin="5"/>
                                    <TextBlock Text="{Binding OptimizedExecutionTime}"
                                             Foreground="Green" FontSize="12" Margin="5"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#E8F5E9" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="✅ Benefits:" FontWeight="Bold" Foreground="Green"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Only raises events when value changes
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Prevents unnecessary UI updates
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Improves performance significantly
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Prevents infinite loop scenarios
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="#FFF3E0" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Performance Comparison:" FontWeight="Bold"/>
                                    <TextBlock Text="{Binding PerformanceComparison}"
                                             TextWrapping="Wrap" FontSize="13" FontWeight="SemiBold"
                                             Foreground="OrangeRed"/>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Tab 2: CallerMemberName -->
            <TabItem Header="CallerMemberName">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Manual Property Name -->
                    <GroupBox Grid.Column="0" Header="Manual Property Names (Error-Prone)">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderStyle}" Text="String Literals"/>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Implementation:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
private string _name = "";
public string Name
{
    get => _name;
    set
    {
        _name = value;
        OnPropertyChanged("Name"); // Hard-coded!
    }
}
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="#FFEBEE" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="❌ Problems:" FontWeight="Bold" Foreground="Red"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12" Margin="0,5,0,0">
                                        • Prone to typos ("Nmae" instead of "Name")
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • No compile-time checking
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Breaks when refactoring property names
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Harder to maintain
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • IDE refactoring tools can't help
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Example Error Scenario:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap" Foreground="Red">
// Property renamed but string not updated!
public string FullName // Was "Name"
{
    set
    {
        _name = value;
        OnPropertyChanged("Name"); // BUG!
    }
}
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="11" Foreground="Red" Margin="5,5,5,0">
                                        Result: UI won't update because property name doesn't match!
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>

                    <!-- CallerMemberName -->
                    <GroupBox Grid.Column="1" Header="CallerMemberName (Safe)">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderStyle}" Text="Automatic Property Name"/>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Implementation:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
protected void OnPropertyChanged(
    [CallerMemberName] string? name = null)
{
    PropertyChanged?.Invoke(this,
        new PropertyChangedEventArgs(name));
}

public string Name
{
    get => _name;
    set
    {
        _name = value;
        OnPropertyChanged(); // Automatic!
    }
}
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="#E8F5E9" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="✅ Benefits:" FontWeight="Bold" Foreground="Green"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12" Margin="0,5,0,0">
                                        • Compiler automatically provides property name
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • No typos possible
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Refactoring-safe
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Clean, readable code
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Zero performance overhead
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Live Demo:" FontWeight="Bold"/>
                                    <TextBox Text="{Binding CallerMemberModel.Name, UpdateSourceTrigger=PropertyChanged}"
                                           Margin="5"/>
                                    <TextBlock Text="Property name automatically captured:"
                                             FontSize="11" Margin="5,5,5,0"/>
                                    <TextBlock Text="{Binding LastPropertyChanged}"
                                             FontFamily="Consolas" FontSize="12"
                                             Foreground="Blue" Margin="5,0,5,5"/>
                                </StackPanel>
                            </Border>

                            <Border Background="#E3F2FD" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Best Practice:" FontWeight="Bold"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12" Margin="0,5,0,0">
                                        Always use CallerMemberName attribute for INPC implementations. It's the modern, safe approach.
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Tab 3: SetProperty Pattern -->
            <TabItem Header="SetProperty Pattern">
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="*"/>
                    </Grid.ColumnDefinitions>

                    <!-- Traditional Pattern -->
                    <GroupBox Grid.Column="0" Header="Traditional Pattern (Verbose)">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderStyle}" Text="Repetitive Code"/>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Implementation:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
private string _firstName = "";
public string FirstName
{
    get => _firstName;
    set
    {
        if (_firstName == value) return;
        _firstName = value;
        OnPropertyChanged();
    }
}

private string _lastName = "";
public string LastName
{
    get => _lastName;
    set
    {
        if (_lastName == value) return;
        _lastName = value;
        OnPropertyChanged();
    }
}
// ... Repeat for every property!
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="#FFF3E0" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Issues:" FontWeight="Bold"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Lots of boilerplate code
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Easy to forget equality check
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Inconsistent across properties
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • More code = more maintenance
                                    </TextBlock>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>

                    <!-- SetProperty Pattern -->
                    <GroupBox Grid.Column="1" Header="SetProperty Pattern (Clean)">
                        <StackPanel>
                            <TextBlock Style="{StaticResource HeaderStyle}" Text="Reusable Helper Method"/>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Helper Method:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
protected bool SetProperty&lt;T&gt;(
    ref T field,
    T value,
    [CallerMemberName] string? name = null)
{
    if (EqualityComparer&lt;T&gt;.Default
        .Equals(field, value))
        return false;

    field = value;
    OnPropertyChanged(name);
    return true;
}
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Usage:" FontWeight="Bold"/>
                                    <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
private string _firstName = "";
public string FirstName
{
    get => _firstName;
    set => SetProperty(ref _firstName, value);
}

private string _lastName = "";
public string LastName
{
    get => _lastName;
    set => SetProperty(ref _lastName, value);
}
// Clean and consistent!
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="#E8F5E9" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="✅ Advantages:" FontWeight="Bold" Foreground="Green"/>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Minimal boilerplate code
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Consistent equality checking
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Returns true if value changed
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Enables dependent property updates
                                    </TextBlock>
                                    <TextBlock TextWrapping="Wrap" FontSize="12">
                                        • Type-safe with generics
                                    </TextBlock>
                                </StackPanel>
                            </Border>

                            <Border Background="White" CornerRadius="5" Padding="10" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="Live Demo:" FontWeight="Bold"/>
                                    <StackPanel Orientation="Horizontal" Margin="5">
                                        <TextBlock Text="First Name:" Width="80"/>
                                        <TextBox Text="{Binding SetPropertyModel.FirstName, UpdateSourceTrigger=PropertyChanged}"
                                               Width="150" Margin="5,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="5">
                                        <TextBlock Text="Last Name:" Width="80"/>
                                        <TextBox Text="{Binding SetPropertyModel.LastName, UpdateSourceTrigger=PropertyChanged}"
                                               Width="150" Margin="5,0"/>
                                    </StackPanel>
                                    <StackPanel Orientation="Horizontal" Margin="5">
                                        <TextBlock Text="Full Name:" Width="80"/>
                                        <TextBlock Text="{Binding SetPropertyModel.FullName}"
                                                 FontWeight="Bold" Margin="5,0"/>
                                    </StackPanel>
                                </StackPanel>
                            </Border>
                        </StackPanel>
                    </GroupBox>
                </Grid>
            </TabItem>

            <!-- Tab 4: Advanced Patterns -->
            <TabItem Header="Advanced Patterns">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel Margin="5">
                        <!-- Dependent Properties -->
                        <GroupBox Header="Dependent Properties">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" Background="White" CornerRadius="5" Padding="10" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Pattern:" FontWeight="Bold"/>
                                        <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
public string FirstName
{
    get => _firstName;
    set
    {
        if (SetProperty(ref _firstName, value))
        {
            OnPropertyChanged(nameof(FullName));
            OnPropertyChanged(nameof(Initials));
        }
    }
}

public string FullName =>
    $"{FirstName} {LastName}";

public string Initials =>
    $"{FirstName[0]}{LastName[0]}";
                                        </TextBlock>
                                    </StackPanel>
                                </Border>

                                <Border Grid.Column="1" Background="White" CornerRadius="5" Padding="10" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Demo:" FontWeight="Bold"/>
                                        <TextBox Text="{Binding DependentModel.FirstName, UpdateSourceTrigger=PropertyChanged}"
                                               Margin="5"/>
                                        <TextBox Text="{Binding DependentModel.LastName, UpdateSourceTrigger=PropertyChanged}"
                                               Margin="5"/>
                                        <TextBlock Text="{Binding DependentModel.FullName, StringFormat='Full Name: {0}'}"
                                                 FontWeight="Bold" Margin="5"/>
                                        <TextBlock Text="{Binding DependentModel.Initials, StringFormat='Initials: {0}'}"
                                                 FontWeight="Bold" Margin="5"/>
                                        <TextBlock Text="{Binding DependentModel.DisplayFormat}"
                                                 FontWeight="Bold" Foreground="Blue" Margin="5"/>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </GroupBox>

                        <!-- Batch Updates -->
                        <GroupBox Header="Batch Updates (Suspend Notifications)">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" Background="White" CornerRadius="5" Padding="10" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Pattern:" FontWeight="Bold"/>
                                        <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
private bool _isBatchUpdate;

public void BeginUpdate()
{
    _isBatchUpdate = true;
}

public void EndUpdate()
{
    _isBatchUpdate = false;
    OnPropertyChanged(string.Empty);
}

protected override void OnPropertyChanged(
    string? propertyName)
{
    if (!_isBatchUpdate)
        base.OnPropertyChanged(propertyName);
}
                                        </TextBlock>
                                    </StackPanel>
                                </Border>

                                <Border Grid.Column="1" Background="White" CornerRadius="5" Padding="10" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Demo:" FontWeight="Bold"/>
                                        <Button Content="Update Without Batch (Slow)" Click="UpdateWithoutBatch_Click" Margin="5"/>
                                        <TextBlock Text="{Binding WithoutBatchTime}" Foreground="Red" Margin="5"/>
                                        <Button Content="Update With Batch (Fast)" Click="UpdateWithBatch_Click" Margin="5"/>
                                        <TextBlock Text="{Binding WithBatchTime}" Foreground="Green" Margin="5"/>
                                        <TextBlock Text="{Binding BatchPerformance}" FontWeight="Bold" Margin="5"/>
                                        <Border Background="#E3F2FD" Padding="5" CornerRadius="3" Margin="5">
                                            <TextBlock TextWrapping="Wrap" FontSize="11">
                                                Batch updates suspend notifications during bulk changes, then raise a single notification at the end.
                                            </TextBlock>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </GroupBox>

                        <!-- PropertyChanging -->
                        <GroupBox Header="INotifyPropertyChanging (Pre-Change Validation)">
                            <Grid>
                                <Grid.ColumnDefinitions>
                                    <ColumnDefinition Width="*"/>
                                    <ColumnDefinition Width="*"/>
                                </Grid.ColumnDefinitions>

                                <Border Grid.Column="0" Background="White" CornerRadius="5" Padding="10" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Pattern:" FontWeight="Bold"/>
                                        <TextBlock Style="{StaticResource CodeStyle}" TextWrapping="Wrap">
public class ValidatingModel :
    INotifyPropertyChanging,
    INotifyPropertyChanged
{
    public int Age
    {
        get => _age;
        set
        {
            OnPropertyChanging(); // Before
            if (value &lt; 0 || value > 120)
                throw new ArgumentException();
            _age = value;
            OnPropertyChanged(); // After
        }
    }
}
                                        </TextBlock>
                                    </StackPanel>
                                </Border>

                                <Border Grid.Column="1" Background="White" CornerRadius="5" Padding="10" Margin="5">
                                    <StackPanel>
                                        <TextBlock Text="Demo:" FontWeight="Bold"/>
                                        <StackPanel Orientation="Horizontal" Margin="5">
                                            <TextBlock Text="Age:" VerticalAlignment="Center" Margin="0,0,10,0"/>
                                            <TextBox x:Name="AgeTextBox" Width="100" Text="25" Margin="0,0,10,0"/>
                                            <Button Content="Validate and Set" Click="ValidateAge_Click"/>
                                        </StackPanel>
                                        <TextBlock Text="{Binding ValidationModel.Age, StringFormat='Current Age: {0}'}"
                                                 FontWeight="Bold" Margin="5"/>
                                        <TextBlock Text="{Binding ValidationMessage}"
                                                 TextWrapping="Wrap" Margin="5"/>
                                        <Border Background="#FFF3E0" Padding="5" CornerRadius="3" Margin="5">
                                            <TextBlock TextWrapping="Wrap" FontSize="11">
                                                PropertyChanging fires before the value changes, allowing validation or cancellation.
                                            </TextBlock>
                                        </Border>
                                    </StackPanel>
                                </Border>
                            </Grid>
                        </GroupBox>

                        <!-- Performance Metrics -->
                        <GroupBox Header="Performance Metrics Summary">
                            <Border Background="White" CornerRadius="5" Padding="15" Margin="5">
                                <StackPanel>
                                    <TextBlock Text="{Binding PerformanceSummary}"
                                             FontFamily="Consolas" FontSize="12" TextWrapping="Wrap"/>
                                </StackPanel>
                            </Border>
                        </GroupBox>
                    </StackPanel>
                </ScrollViewer>
            </TabItem>
        </TabControl>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#424242" CornerRadius="5" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock Grid.Column="0" Text="{Binding StatusMessage}"
                          Foreground="White" VerticalAlignment="Center"/>
                <TextBlock Grid.Column="1" Text="{Binding CurrentMemory, StringFormat='Memory: {0:N2} MB'}"
                          Foreground="#4CAF50" VerticalAlignment="Center" Margin="10,0,0,0"/>
            </Grid>
        </Border>
    </Grid>
</Window>
