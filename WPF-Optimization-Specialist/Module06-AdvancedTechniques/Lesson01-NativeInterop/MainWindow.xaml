<Window x:Class="NativeInteropApp.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Native Interop Optimization - Module 6 Lesson 1"
        Height="800" Width="1200"
        WindowStartupLocation="CenterScreen">
    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Header -->
        <Border Grid.Row="0" Background="#2C3E50" Padding="15">
            <StackPanel>
                <TextBlock Text="Native Interop &amp; Unsafe Code Optimization"
                          FontSize="24" FontWeight="Bold" Foreground="White"/>
                <TextBlock Text="P/Invoke optimization, unsafe code, and native memory management"
                          FontSize="14" Foreground="#ECF0F1" Margin="0,5,0,0"/>
            </StackPanel>
        </Border>

        <!-- Main Content -->
        <ScrollViewer Grid.Row="1" VerticalScrollBarVisibility="Auto">
            <StackPanel Margin="10">

                <!-- Memory Copy Operations -->
                <GroupBox Header="Memory Copy Operations (P/Invoke vs Unsafe)" FontWeight="Bold">
                    <StackPanel>
                        <TextBlock FontWeight="Normal" TextWrapping="Wrap" Margin="0,0,0,10">
                            Compare different methods of copying memory: managed array copy, P/Invoke memcpy, and unsafe pointer operations.
                        </TextBlock>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0">
                                <TextBlock Text="Array Size:" FontWeight="Normal"/>
                                <Slider x:Name="MemorySizeSlider" Minimum="10" Maximum="26" Value="20"
                                       TickFrequency="1" IsSnapToTickEnabled="True" Margin="5"/>
                                <TextBlock FontWeight="Normal">
                                    <Run Text="Size: "/>
                                    <Run x:Name="MemorySizeText" Text="1 MB" FontWeight="Bold"/>
                                </TextBlock>
                            </StackPanel>

                            <StackPanel Grid.Column="1">
                                <TextBlock Text="Iterations:" FontWeight="Normal"/>
                                <Slider x:Name="IterationsSlider" Minimum="1" Maximum="1000" Value="100"
                                       TickFrequency="50" Margin="5"/>
                                <TextBlock FontWeight="Normal">
                                    <Run Text="Count: "/>
                                    <Run x:Name="IterationsText" Text="100" FontWeight="Bold"/>
                                </TextBlock>
                            </StackPanel>
                        </Grid>

                        <UniformGrid Rows="1" Columns="4" Margin="0,10,0,0">
                            <Button x:Name="ManagedCopyBtn" Content="Managed Copy" Click="ManagedCopyBtn_Click"/>
                            <Button x:Name="PInvokeCopyBtn" Content="P/Invoke memcpy" Click="PInvokeCopyBtn_Click"/>
                            <Button x:Name="UnsafeCopyBtn" Content="Unsafe Copy" Click="UnsafeCopyBtn_Click"/>
                            <Button x:Name="CompareAllCopyBtn" Content="Compare All" Click="CompareAllCopyBtn_Click"/>
                        </UniformGrid>

                        <Border Background="#F8F9FA" Padding="10" Margin="0,10,0,0" BorderBrush="#DEE2E6" BorderThickness="1">
                            <TextBlock x:Name="MemoryCopyResults" FontFamily="Consolas" FontSize="12"
                                      TextWrapping="Wrap" FontWeight="Normal"/>
                        </Border>
                    </StackPanel>
                </GroupBox>

                <!-- String Operations -->
                <GroupBox Header="High-Performance String Operations" FontWeight="Bold">
                    <StackPanel>
                        <TextBlock FontWeight="Normal" TextWrapping="Wrap" Margin="0,0,0,10">
                            Optimize string operations using unsafe code for character-level manipulation.
                        </TextBlock>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="Auto"/>
                            </Grid.ColumnDefinitions>

                            <TextBox x:Name="InputStringBox" Grid.Column="0" Height="60" TextWrapping="Wrap"
                                    VerticalScrollBarVisibility="Auto" Margin="5"
                                    Text="The quick brown fox jumps over the lazy dog. This is a sample text for testing various string operations with managed and unsafe code implementations."/>

                            <StackPanel Grid.Column="1">
                                <Button x:Name="ReverseStringBtn" Content="Reverse (Unsafe)" Click="ReverseStringBtn_Click"/>
                                <Button x:Name="ToUpperUnsafeBtn" Content="ToUpper (Unsafe)" Click="ToUpperUnsafeBtn_Click"/>
                                <Button x:Name="CountCharsBtn" Content="Count Chars" Click="CountCharsBtn_Click"/>
                            </StackPanel>
                        </Grid>

                        <Border Background="#F8F9FA" Padding="10" Margin="0,10,0,0" BorderBrush="#DEE2E6" BorderThickness="1">
                            <TextBlock x:Name="StringOperationResults" FontFamily="Consolas" FontSize="12"
                                      TextWrapping="Wrap" FontWeight="Normal"/>
                        </Border>
                    </StackPanel>
                </GroupBox>

                <!-- Native Window Operations -->
                <GroupBox Header="Native Windows API (P/Invoke Optimization)" FontWeight="Bold">
                    <StackPanel>
                        <TextBlock FontWeight="Normal" TextWrapping="Wrap" Margin="0,0,0,10">
                            Demonstrate optimized P/Invoke patterns for Windows API calls.
                        </TextBlock>

                        <UniformGrid Rows="1" Columns="4">
                            <Button x:Name="GetSystemInfoBtn" Content="Get System Info" Click="GetSystemInfoBtn_Click"/>
                            <Button x:Name="GetMemoryInfoBtn" Content="Get Memory Info" Click="GetMemoryInfoBtn_Click"/>
                            <Button x:Name="FlashWindowBtn" Content="Flash Window" Click="FlashWindowBtn_Click"/>
                            <Button x:Name="GetPerformanceBtn" Content="Performance Info" Click="GetPerformanceBtn_Click"/>
                        </UniformGrid>

                        <Border Background="#F8F9FA" Padding="10" Margin="0,10,0,0" BorderBrush="#DEE2E6" BorderThickness="1">
                            <TextBlock x:Name="NativeApiResults" FontFamily="Consolas" FontSize="12"
                                      TextWrapping="Wrap" FontWeight="Normal"/>
                        </Border>
                    </StackPanel>
                </GroupBox>

                <!-- Bitmap Processing -->
                <GroupBox Header="Unsafe Bitmap Processing" FontWeight="Bold">
                    <StackPanel>
                        <TextBlock FontWeight="Normal" TextWrapping="Wrap" Margin="0,0,0,10">
                            High-performance image processing using unsafe pointer arithmetic.
                        </TextBlock>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="Auto"/>
                                <ColumnDefinition Width="*"/>
                            </Grid.ColumnDefinitions>

                            <StackPanel Grid.Column="0" Margin="0,0,10,0">
                                <TextBlock Text="Image Size:" FontWeight="Normal"/>
                                <ComboBox x:Name="ImageSizeCombo" SelectedIndex="1" Margin="5">
                                    <ComboBoxItem Content="256x256"/>
                                    <ComboBoxItem Content="512x512"/>
                                    <ComboBoxItem Content="1024x1024"/>
                                    <ComboBoxItem Content="2048x2048"/>
                                </ComboBox>

                                <Button x:Name="GenerateImageBtn" Content="Generate Test Image"
                                       Click="GenerateImageBtn_Click" Margin="5,10,5,5"/>
                                <Button x:Name="GrayscaleManagedBtn" Content="Grayscale (Managed)"
                                       Click="GrayscaleManagedBtn_Click"/>
                                <Button x:Name="GrayscaleUnsafeBtn" Content="Grayscale (Unsafe)"
                                       Click="GrayscaleUnsafeBtn_Click"/>
                                <Button x:Name="InvertUnsafeBtn" Content="Invert (Unsafe)"
                                       Click="InvertUnsafeBtn_Click"/>
                                <Button x:Name="BlurUnsafeBtn" Content="Blur (Unsafe)"
                                       Click="BlurUnsafeBtn_Click"/>
                            </StackPanel>

                            <Border Grid.Column="1" BorderBrush="#DEE2E6" BorderThickness="1">
                                <Image x:Name="ProcessedImage" Stretch="Uniform" Height="300"/>
                            </Border>
                        </Grid>

                        <Border Background="#F8F9FA" Padding="10" Margin="0,10,0,0" BorderBrush="#DEE2E6" BorderThickness="1">
                            <TextBlock x:Name="ImageProcessingResults" FontFamily="Consolas" FontSize="12"
                                      TextWrapping="Wrap" FontWeight="Normal"/>
                        </Border>
                    </StackPanel>
                </GroupBox>

                <!-- Performance Comparison -->
                <GroupBox Header="Overall Performance Analysis" FontWeight="Bold">
                    <StackPanel>
                        <Border Background="#E8F5E9" Padding="10" BorderBrush="#4CAF50" BorderThickness="2">
                            <TextBlock x:Name="PerformanceSummary" FontFamily="Consolas" FontSize="12"
                                      TextWrapping="Wrap" FontWeight="Normal"
                                      Text="Run benchmarks to see performance comparisons between managed and native/unsafe code."/>
                        </Border>
                    </StackPanel>
                </GroupBox>

            </StackPanel>
        </ScrollViewer>

        <!-- Status Bar -->
        <Border Grid.Row="2" Background="#34495E" Padding="10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>
                <TextBlock x:Name="StatusText" Grid.Column="0" Foreground="White" VerticalAlignment="Center"
                          Text="Ready. Select operations to test native interop and unsafe code performance."/>
                <TextBlock Grid.Column="1" Foreground="#ECF0F1" VerticalAlignment="Center">
                    <Run Text="GC Memory: "/>
                    <Run x:Name="GCMemoryText" Text="0 MB" FontWeight="Bold"/>
                </TextBlock>
            </Grid>
        </Border>
    </Grid>
</Window>
