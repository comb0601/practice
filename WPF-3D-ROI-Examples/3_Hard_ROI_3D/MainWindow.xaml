<Window x:Class="Hard_ROI_3D.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Hard 3D ROI - Professional Editor" Height="800" Width="1400"
        Background="#1E1E1E">
    <DockPanel>
        <!-- Menu Bar -->
        <Menu DockPanel.Dock="Top" Background="#2D2D30" Foreground="White">
            <MenuItem Header="File" Foreground="White">
                <MenuItem Header="New Scene" Click="NewScene_Click"/>
                <MenuItem Header="Save Scene" Click="SaveScene_Click"/>
                <MenuItem Header="Load Scene" Click="LoadScene_Click"/>
                <Separator/>
                <MenuItem Header="Export View" Click="ExportView_Click"/>
            </MenuItem>
            <MenuItem Header="View" Foreground="White">
                <MenuItem Header="Show Grid" IsCheckable="True" IsChecked="True" Click="ToggleGrid_Click"/>
                <MenuItem Header="Show Axes" IsCheckable="True" IsChecked="True" Click="ToggleAxes_Click"/>
                <MenuItem Header="Wireframe Mode" IsCheckable="True" Click="ToggleWireframe_Click"/>
            </MenuItem>
            <MenuItem Header="Tools" Foreground="White">
                <MenuItem Header="Measure Distance" Click="MeasureDistance_Click"/>
                <MenuItem Header="Show Statistics" Click="ShowStats_Click"/>
            </MenuItem>
        </Menu>

        <!-- Status Bar -->
        <StatusBar DockPanel.Dock="Bottom" Background="#007ACC" Foreground="White">
            <StatusBarItem>
                <TextBlock x:Name="statusText" Text="Ready | Camera: Orbit Mode | ROIs: 0"/>
            </StatusBarItem>
            <Separator/>
            <StatusBarItem>
                <TextBlock x:Name="positionText" Text="Position: 0, 0, 0"/>
            </StatusBarItem>
        </StatusBar>

        <Grid>
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="220"/>
                <ColumnDefinition Width="*"/>
                <ColumnDefinition Width="320"/>
            </Grid.ColumnDefinitions>

            <!-- Left Panel - ROI List -->
            <Border Grid.Column="0" Background="#252526" Margin="2">
                <DockPanel>
                    <StackPanel DockPanel.Dock="Top" Background="#2D2D30" Margin="0,0,0,5">
                        <TextBlock Text="ROI MANAGER"
                                 Foreground="White"
                                 FontSize="13"
                                 FontWeight="Bold"
                                 Padding="10,8"
                                 Background="#007ACC"/>

                        <WrapPanel Margin="5">
                            <Button Content="+" Click="AddROI_Click" ToolTip="Add ROI"
                                    Width="30" Height="30" Margin="2" Background="#0E639C" Foreground="White" FontWeight="Bold" FontSize="16" BorderThickness="0"/>
                            <Button Content="−" Click="RemoveROI_Click" ToolTip="Remove ROI"
                                    Width="30" Height="30" Margin="2" Background="#A12026" Foreground="White" FontWeight="Bold" FontSize="16" BorderThickness="0"/>
                            <Button Content="⎘" Click="DuplicateROI_Click" ToolTip="Duplicate ROI"
                                    Width="30" Height="30" Margin="2" Background="#4A5F7A" Foreground="White" FontWeight="Bold" FontSize="14" BorderThickness="0"/>
                            <Button Content="↑" Click="MoveUp_Click" ToolTip="Move Up"
                                    Width="30" Height="30" Margin="2" Background="#4A5F7A" Foreground="White" FontWeight="Bold" FontSize="14" BorderThickness="0"/>
                            <Button Content="↓" Click="MoveDown_Click" ToolTip="Move Down"
                                    Width="30" Height="30" Margin="2" Background="#4A5F7A" Foreground="White" FontWeight="Bold" FontSize="14" BorderThickness="0"/>
                        </WrapPanel>
                    </StackPanel>

                    <ListBox x:Name="roiListBox"
                             SelectionChanged="ROIList_SelectionChanged"
                             Background="#1E1E1E"
                             Foreground="White"
                             BorderThickness="0">
                        <ListBox.ItemTemplate>
                            <DataTemplate>
                                <StackPanel Orientation="Horizontal">
                                    <CheckBox IsChecked="{Binding Visible}"
                                             Checked="Visibility_Changed"
                                             Unchecked="Visibility_Changed"
                                             Margin="0,0,5,0"/>
                                    <Ellipse Width="12" Height="12" Margin="0,0,5,0">
                                        <Ellipse.Fill>
                                            <SolidColorBrush Color="{Binding Color}"/>
                                        </Ellipse.Fill>
                                    </Ellipse>
                                    <TextBlock Text="{Binding}" Foreground="White"/>
                                </StackPanel>
                            </DataTemplate>
                        </ListBox.ItemTemplate>
                    </ListBox>
                </DockPanel>
            </Border>

            <!-- Center - 3D Viewport -->
            <Border Grid.Column="1" Background="Black" Margin="2">
                <Grid>
                    <Viewport3D x:Name="viewport3D"
                               MouseLeftButtonDown="Viewport_MouseLeftButtonDown"
                               MouseMove="Viewport_MouseMove"
                               MouseWheel="Viewport_MouseWheel">
                        <Viewport3D.Camera>
                            <PerspectiveCamera x:Name="camera"
                                             Position="10,10,20"
                                             LookDirection="-10,-10,-20"
                                             UpDirection="0,1,0"
                                             FieldOfView="60"/>
                        </Viewport3D.Camera>

                        <!-- Lights -->
                        <ModelVisual3D>
                            <ModelVisual3D.Content>
                                <Model3DGroup>
                                    <AmbientLight Color="#606060"/>
                                    <DirectionalLight Color="#FFFFFF" Direction="-1,-1,-3"/>
                                    <DirectionalLight Color="#909090" Direction="1,1,3"/>
                                    <DirectionalLight Color="#505050" Direction="0,-1,0"/>
                                    <DirectionalLight Color="#404040" Direction="0,1,0"/>
                                </Model3DGroup>
                            </ModelVisual3D.Content>
                        </ModelVisual3D>

                        <!-- Grid -->
                        <ModelVisual3D x:Name="gridModel"/>

                        <!-- Axes -->
                        <ModelVisual3D x:Name="axesModel"/>

                        <!-- Clipping Plane Visual -->
                        <ModelVisual3D x:Name="clippingPlaneModel"/>

                        <!-- ROI Container -->
                        <ModelVisual3D x:Name="roiContainer"/>

                    </Viewport3D>

                    <!-- Overlay Info -->
                    <StackPanel VerticalAlignment="Top" HorizontalAlignment="Left" Margin="10">
                        <Border Background="#AA000000" Padding="8" CornerRadius="3">
                            <StackPanel>
                                <TextBlock x:Name="cameraInfoText" Text="Camera: 0°, 0°" Foreground="White" FontSize="10"/>
                                <TextBlock x:Name="roiCountText" Text="ROIs: 0" Foreground="White" FontSize="10" Margin="0,2,0,0"/>
                            </StackPanel>
                        </Border>
                    </StackPanel>
                </Grid>
            </Border>

            <!-- Right Panel - Properties -->
            <Border Grid.Column="2" Background="#2D2D30" Margin="2">
                <ScrollViewer VerticalScrollBarVisibility="Auto">
                    <StackPanel x:Name="propertiesPanel" Margin="12">
                        <TextBlock Text="PROPERTIES"
                                 Foreground="White"
                                 FontSize="13"
                                 FontWeight="Bold"
                                 Margin="0,0,0,12"/>

                        <!-- ROI Name -->
                        <TextBlock Text="Name" Foreground="#AAA" FontSize="10" Margin="0,5,0,2"/>
                        <TextBox x:Name="txtName" Background="#1E1E1E" Foreground="White" BorderBrush="#555"
                                 TextChanged="Name_Changed" Padding="4"/>

                        <!-- Shape -->
                        <TextBlock Text="SHAPE" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,12,0,5"/>
                        <ComboBox x:Name="shapeCombo" SelectionChanged="Shape_Changed" Background="#1E1E1E" Foreground="White">
                            <ComboBoxItem Content="Box"/>
                            <ComboBoxItem Content="Sphere"/>
                            <ComboBoxItem Content="Cylinder"/>
                            <ComboBoxItem Content="Cone"/>
                            <ComboBoxItem Content="Torus"/>
                        </ComboBox>

                        <!-- Position -->
                        <TextBlock Text="POSITION" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,15,0,5"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="40"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="X" Foreground="#F48771" FontWeight="Bold" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="0" Grid.Column="1" x:Name="sliderPosX" Minimum="-10" Maximum="10" Value="0" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="0" Grid.Column="2" x:Name="txtPosX" Text="0.0" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Y" Foreground="#7CC379" FontWeight="Bold" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="1" Grid.Column="1" x:Name="sliderPosY" Minimum="-10" Maximum="10" Value="0" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="1" Grid.Column="2" x:Name="txtPosY" Text="0.0" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Z" Foreground="#78A8F4" FontWeight="Bold" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="2" Grid.Column="1" x:Name="sliderPosZ" Minimum="-10" Maximum="10" Value="0" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="2" Grid.Column="2" x:Name="txtPosZ" Text="0.0" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>
                        </Grid>

                        <!-- Size -->
                        <TextBlock Text="SIZE" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,12,0,5"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="50"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="40"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="Width" Foreground="#AAA" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="0" Grid.Column="1" x:Name="sliderWidth" Minimum="0.5" Maximum="8" Value="2" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="0" Grid.Column="2" x:Name="txtWidth" Text="2.0" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Height" Foreground="#AAA" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="1" Grid.Column="1" x:Name="sliderHeight" Minimum="0.5" Maximum="8" Value="2" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="1" Grid.Column="2" x:Name="txtHeight" Text="2.0" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Depth" Foreground="#AAA" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="2" Grid.Column="1" x:Name="sliderDepth" Minimum="0.5" Maximum="8" Value="2" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="2" Grid.Column="2" x:Name="txtDepth" Text="2.0" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>
                        </Grid>

                        <!-- Rotation -->
                        <TextBlock Text="ROTATION" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,12,0,5"/>

                        <Grid>
                            <Grid.ColumnDefinitions>
                                <ColumnDefinition Width="15"/>
                                <ColumnDefinition Width="*"/>
                                <ColumnDefinition Width="40"/>
                            </Grid.ColumnDefinitions>
                            <Grid.RowDefinitions>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                                <RowDefinition Height="Auto"/>
                            </Grid.RowDefinitions>

                            <TextBlock Grid.Row="0" Grid.Column="0" Text="X" Foreground="#F48771" FontWeight="Bold" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="0" Grid.Column="1" x:Name="sliderRotX" Minimum="0" Maximum="360" Value="0" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="0" Grid.Column="2" x:Name="txtRotX" Text="0°" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>

                            <TextBlock Grid.Row="1" Grid.Column="0" Text="Y" Foreground="#7CC379" FontWeight="Bold" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="1" Grid.Column="1" x:Name="sliderRotY" Minimum="0" Maximum="360" Value="0" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="1" Grid.Column="2" x:Name="txtRotY" Text="0°" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>

                            <TextBlock Grid.Row="2" Grid.Column="0" Text="Z" Foreground="#78A8F4" FontWeight="Bold" FontSize="10" Margin="0,8,0,0"/>
                            <Slider Grid.Row="2" Grid.Column="1" x:Name="sliderRotZ" Minimum="0" Maximum="360" Value="0" ValueChanged="Property_Changed" Margin="3,5"/>
                            <TextBox Grid.Row="2" Grid.Column="2" x:Name="txtRotZ" Text="0°" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10"/>
                        </Grid>

                        <!-- Appearance -->
                        <TextBlock Text="APPEARANCE" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,15,0,5"/>

                        <TextBlock Text="Color" Foreground="#AAA" FontSize="10" Margin="0,5,0,2"/>
                        <ComboBox x:Name="colorCombo" SelectionChanged="Color_Changed" Background="#1E1E1E" Foreground="White" Margin="0,0,0,8">
                            <ComboBoxItem Content="Red" Tag="#FF0000"/>
                            <ComboBoxItem Content="Green" Tag="#00FF00"/>
                            <ComboBoxItem Content="Blue" Tag="#0000FF"/>
                            <ComboBoxItem Content="Yellow" Tag="#FFFF00"/>
                            <ComboBoxItem Content="Cyan" Tag="#00FFFF"/>
                            <ComboBoxItem Content="Magenta" Tag="#FF00FF"/>
                            <ComboBoxItem Content="Orange" Tag="#FF8000"/>
                            <ComboBoxItem Content="Purple" Tag="#8000FF"/>
                        </ComboBox>

                        <TextBlock Text="Opacity" Foreground="#AAA" FontSize="10" Margin="0,8,0,2"/>
                        <DockPanel Margin="0,0,0,8">
                            <TextBox DockPanel.Dock="Right" x:Name="txtOpacity" Text="50%" Width="40" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10" TextAlignment="Right"/>
                            <Slider x:Name="sliderOpacity" Minimum="10" Maximum="100" Value="50" ValueChanged="Opacity_Changed" Margin="0,0,5,0"/>
                        </DockPanel>

                        <CheckBox x:Name="chkWireframe" Content="Show Wireframe" Foreground="White" IsChecked="True" Checked="Wireframe_Changed" Unchecked="Wireframe_Changed"/>

                        <!-- Info -->
                        <TextBlock Text="INFO" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,15,0,5"/>
                        <Border Background="#1E1E1E" BorderBrush="#555" BorderThickness="1" Padding="8" CornerRadius="3">
                            <StackPanel>
                                <TextBlock x:Name="txtVolume" Text="Volume: 0.00" Foreground="#AAA" FontSize="10"/>
                                <TextBlock x:Name="txtCenter" Text="Center: (0, 0, 0)" Foreground="#AAA" FontSize="10" Margin="0,3,0,0"/>
                            </StackPanel>
                        </Border>

                        <!-- Clipping Plane -->
                        <TextBlock Text="CLIPPING PLANE" Foreground="#4EC9B0" FontWeight="Bold" Margin="0,15,0,5"/>

                        <CheckBox x:Name="chkEnableClipping" Content="Enable Clipping" Foreground="White" Checked="Clipping_Changed" Unchecked="Clipping_Changed" Margin="0,5,0,8"/>

                        <TextBlock Text="Clip Position (Y)" Foreground="#AAA" FontSize="10" Margin="0,5,0,2"/>
                        <DockPanel>
                            <TextBox DockPanel.Dock="Right" x:Name="txtClipY" Text="0.0" Width="40" Background="#1E1E1E" Foreground="White" BorderBrush="#555" Padding="2" FontSize="10" TextAlignment="Right"/>
                            <Slider x:Name="sliderClipY" Minimum="-10" Maximum="10" Value="0" ValueChanged="ClipPlane_Changed" Margin="0,0,5,0"/>
                        </DockPanel>

                        <TextBlock Text="Hard Version"
                                 Foreground="#666"
                                 FontSize="10"
                                 Margin="0,30,0,0"
                                 HorizontalAlignment="Center"/>
                    </StackPanel>
                </ScrollViewer>
            </Border>
        </Grid>
    </DockPanel>
</Window>
